#!/usr/bin/env ruby
$:.unshift "#{File.dirname(__FILE__)}/../lib"

require "pipe2me"
require "pipe2me/cli"
require "pipe2me/cli-foreman"
require "pipe2me/cli-monit"

if ENV["BACKTRACE"].to_i == 1
  Pipe2me::CLI.start ARGV
  exit 0
end

begin
  Pipe2me::CLI.start ARGV
rescue
  if UI.verbosity >= 2
    UI.error $!.message
    raise
  elsif UI.verbosity >= 0
    UI.error $!.message
  else
    STDERR.puts $!.message
  end
  exit 1
end
